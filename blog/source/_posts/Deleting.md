title: Блог джуниора. Удаление из БД subtitle: Удаление из БД author: Горшунов Владимир tags: [Блог джуниора] <br>
Задачей было сделать кнопку delete, которая бы удаляла пользователя из базы данных и, соответственно, со страницы.<!-- more -->

В поисках истины набрёл на jquery, юзал давно, вспоминал, что да как.

jQuery — библиотека Javascript, фокусирующаяся на взаимодействии JavaScript и HTML.
Удобно работать с DOM'ом(Document Object Model). Подключается одной строчкой:

    <script type="text/javascript" src="Путь к jQuery"></script>

Вся работа с jQuery ведётся с помощью функции $. Если в проекте используются другие JavaScript библиотеки, где используется $, то можно заменять её синонимом jQuery.

В теории, обработку нажатия будет делать jquery и отправлять post-запрос на сервер.
Post-запрос позволяет передавать данные в стандартном потоке, а get — лишь через адрес. В принципе, подошел бы и второй вариант, думаю, что рассмотрю это позднее.

Прописал путь(route) для кнопки, контроллер в процессе написания.


    $( document ).ready(function() { //Когда DOM готов
      $(".delete").click(function(event){ // отслеживаем ивент по нажатию на кнопку delete
    	  var that = this; // создаем копию переменной this, называем that, для дальнейшего использования
    	  $.post("/delete", { id: $(this).attr("data-id") }, function(data){ // Отправляем post-запрос на сервер, передавая id пользователя
    	  	if (data.success){ // проверяем пришло ли сообщение с сервера об "успехе"
    	  		$(that).parent().remove(); // и если данные из бд удалены удаляем строчку со странички
    	  	}
    	  });
    	});
    });

#### Post-запрос по клику на кнопку delete

    <button class="delete" data-id="{{=user.id}}" >delete</button>

#### Обрабатываем путь:

    app.post('/delete', secretController.del); // сервер принимает post-запрос и выполняет функцию del, которая находится во внешнем контроллере secretController

#### Контроллер:

    exports.del = function(req, res) {
    	User.findById(req.body.id, function (err, user) { // ищем пользователя в БД по id
    		user.remove(); // удаляем его
    	  return res.send ({success: true}); // И возвращаем сообщение о том, что всё прошло успешно
    	});
    };